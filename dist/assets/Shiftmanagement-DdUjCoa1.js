import{q as T,r as l,j as e}from"./index-C8M8d5TP.js";import{C as c,a as r}from"./CRow-DwbOyR1O.js";import{C as E,a as I}from"./CCardBody-BC-1MHGB.js";import{C as v}from"./CCardHeader-Cy4Bd0Ol.js";import{C as b}from"./CForm-w6XIb02x.js";import{C as d}from"./CFormLabel-Dc_uzIQC.js";import{C as u}from"./CFormInput-Bd3bcSFW.js";import{C as k}from"./CFormSelect-DPn45vPc.js";import{C as F}from"./CFormTextarea-CI9dEni-.js";import{a as A}from"./index.esm-D35apfu2.js";import{C as R,a as D,b as j,c as h,d as B,e as a}from"./CTable-DhOiOdMA.js";import"./CFormControlWrapper-CObUvOP_.js";import"./CFormControlValidation-1FHZm8X5.js";const Q=()=>{const C=T();l.useEffect(()=>{localStorage.getItem("token")||C("/login")},[C]);const[i,m]=l.useState({employeeId:"",employeeName:"",shiftType:"",notes:""}),[g,S]=l.useState([]),[p,f]=l.useState([]);l.useEffect(()=>{const t=localStorage.getItem("token");t?fetch("http://localhost:1000/api/employee-records",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(o=>o.json()).then(o=>S(o)).catch(o=>console.error("Error fetching employee records:",o)):console.error("No token found!")},[]),l.useEffect(()=>{const t=localStorage.getItem("token");t?fetch("http://localhost:1000/api/shifts",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(o=>o.json()).then(o=>{o&&o.data&&Array.isArray(o.data)?f(o.data):(console.error("Invalid data structure",o),f([]))}).catch(o=>console.error("Error fetching shift records:",o)):console.error("No token found!")},[]);const x=t=>{const{name:o,value:s}=t.target;if(m(n=>({...n,[o]:s})),o==="employeeId"){const n=g.find(y=>y.employeeId===s);m(y=>({...y,employeeName:n?n.name:""}))}},N=()=>{const t={...i,shiftId:Math.random().toString(36).substr(2,9)},o=localStorage.getItem("token");o?fetch("http://localhost:1000/api/shift",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>{s&&s.message==="Shift record saved successfully!"&&(f(n=>[...n,t]),m({employeeId:"",employeeName:"",shiftType:"",notes:""}),alert("Shift record saved successfully!"))}).catch(s=>console.error("Error saving shift record:",s)):console.error("No token found!")};return e.jsx(c,{children:e.jsx(r,{xs:12,children:e.jsxs(E,{className:"mb-4",children:[e.jsx(v,{children:e.jsx("strong",{children:"Shift Management"})}),e.jsxs(I,{children:[e.jsxs(b,{children:[e.jsxs(c,{children:[e.jsxs(r,{md:6,children:[e.jsx(d,{htmlFor:"employeeId",children:"Employee ID"}),e.jsx(u,{type:"text",id:"employeeId",name:"employeeId",value:i.employeeId,onChange:x,placeholder:"Enter employee ID"})]}),e.jsxs(r,{md:6,children:[e.jsx(d,{htmlFor:"employeeName",children:"Employee Name"}),e.jsx(u,{type:"text",id:"employeeName",name:"employeeName",value:i.employeeName,readOnly:!0,placeholder:"Employee name will be auto-filled"})]})]}),e.jsxs(c,{className:"mt-3",children:[e.jsxs(r,{md:6,children:[e.jsx(d,{htmlFor:"shiftType",children:"Shift Type"}),e.jsxs(k,{id:"shiftType",name:"shiftType",value:i.shiftType,onChange:x,children:[e.jsx("option",{value:"",children:"Select Shift Type"}),e.jsx("option",{value:"morning",children:"Morning Shift"}),e.jsx("option",{value:"evening",children:"Evening Shift"}),e.jsx("option",{value:"night",children:"Night Shift"})]})]}),e.jsxs(r,{md:6,children:[e.jsx(d,{htmlFor:"notes",children:"Additional Notes"}),e.jsx(F,{id:"notes",name:"notes",value:i.notes,onChange:x,rows:"3",placeholder:"Enter any additional notes"})]})]}),e.jsx(c,{className:"mt-4",children:e.jsx(r,{md:2,children:e.jsx(A,{color:"primary",onClick:N,children:"Save Shift"})})})]}),e.jsx(c,{className:"mt-5",children:e.jsx(r,{xs:12,children:e.jsxs(R,{striped:!0,children:[e.jsx(D,{children:e.jsxs(j,{children:[e.jsx(h,{children:"#"}),e.jsx(h,{children:"Employee ID"}),e.jsx(h,{children:"Employee Name"}),e.jsx(h,{children:"Shift Type"}),e.jsx(h,{children:"Notes"})]})}),e.jsx(B,{children:Array.isArray(p)&&p.length>0?p.map((t,o)=>e.jsxs(j,{children:[e.jsx(a,{children:o+1}),e.jsx(a,{children:t.employeeId}),e.jsx(a,{children:t.employeeName}),e.jsx(a,{children:t.shiftType}),e.jsx(a,{children:t.notes})]},t._id)):e.jsx(j,{children:e.jsx(a,{colSpan:"5",className:"text-center",children:"No shift records available."})})})]})})})]})]})})})};export{Q as default};
